<!--
Copyright (c) 2014 Bowery, Inc. All rights reserved.
-->

<!--
`bowery-modal` is a hot looking modal that expands from a colorful circle button.
A major limitation is that it cannot be used inside elments with `overflow: hidden;`
  <bowery-auth></bowery-auth>

@group Bowery Core Elements
@element bowery-modal
-->

<link rel="import" href="../polymer/polymer.html">

<polymer-element name="bowery-modal" attributes="type expanded">
<template>
<link rel="stylesheet" href="../../bowery/out.css">
<style>
  :host {
    position: absolute;
  }
  #circle {
    border-radius: 100%;

    transition: all 300ms ease-in;
    transform: scale(0.1);

    width: 180px;
    height: 180px;

    top: 0;
    right: 0;
    position: absolute;
    margin-right: -90px;
    margin-top: -90px;

    cursor: pointer;

    z-index: 2;
  }

  #circle.large {
    transform: scale(6);
    vertical-align: middle;
    z-index: 3;
  }

  #content {
    display: none;
    opacity: 0;
    transition: width 500ms ease-in 1s;
    position: absolute;
    left: -345px;
    color: rgb(245, 245, 245); /*TODO (thebyrd) make this white, but not until red is behind it*/
    width: 0;
  }
  #content.show {
    display: block;
    opacity: 1;
    width: 345px;
  }
  #content.show * {
    z-index: 4;
  }
  .inner-content {
    position: relative;
    padding: 18px;
  }
  .close {
    position: absolute;
    right: 0;
    top: 18px;
    font-size: 18px;
    background: none;
    border: none;
    outline: none;
    color: rgb(245, 245, 245);
    cursor: pointer;
  }
  h1, h2, h3, h4, p, span {
    color: white;
  }
  pre {
    color: rgb(245, 245, 245);
  }
</style>

<div id="circle" class="{{this.circleClass}}" on-click="{{expandCircle}}"></div>
<div id="content">
  <div class="inner-content">
    <button class="close" on-click="{{shrinkCircle}}">X</button>
    <template if="{{type == 'error'}}">
      <h1>Error</h1>
      <h2>What command should I run to fix this?</h2>
      <pre style="overflow: auto">
2014/08/29 14:16:51 /Users/david/Documents/gocode/src/github.com/Bowery/desktop/bin
[negroni] listening on :32055
[negroni] listen tcp :32055: bind: address already in use
      </pre>
      <textarea style="outline: none; width: 100%; height: 126px; background: white; border: none; resize: none;"></textarea>
    </template>

    <template if="{{type == 'edit'}}">
      <content></content>
    </template>

    <!-- <template if="{{type == 'info'}}">
      <h1>Info</h1>
      <h2>Important Message</h2>
      <p>Semiotics hashtag cred, Schlitz before they sold out deep v tousled fingerstache freegan. Tumblr whatever farm-to-table pork belly. Gluten-free food truck seitan banjo readymade.</p>
    </template> -->


  </div>
</div>

</template>
<script>
Polymer('bowery-modal', {
  ready: function () {
    this.expanded = false
    this.circleState = "small"

    var circle = this.$.circle

    if (this.type == 'error')
      circle.style.background = "rgb(251, 77, 83)"

    if (this.type == 'info') {
      circle.style.background = "rgb(94, 219, 196)"
      // circle.style.background = "rgb(52, 145, 226)"
    }

    if (this.type == 'progress') {
      circle.style.background = "rgb(244, 172, 88)"
    }

    if (this.type == 'edit') {
      circle.style.background = "rgb(26, 23, 24)"
    }

  },
  capitalize: function (str) {
    return str.charAt(0).toUpperCase() + str.substring(1)
  },
  calcRelPos: function (attr, pos) {
    return (pos - this.getBoundingClientRect()[attr]) + "px"
  },
  expandCircle: function () {
    this.expanded = true
    this.$.circle.setAttribute("class", "large")
    this.$.content.setAttribute("class", "show")

    this.$.content.style.top = this.calcRelPos('top', 65)
    this.$.content.style.left = "-345px"

    this.fire('bowery-modal-open')
  },
  shrinkCircle: function () {
    this.expanded = false
    this.$.circle.setAttribute("class", "")
    this.$.content.setAttribute("class", "")

    this.fire('bowery-modal-close')
  }
})
</script>
</polymer-element>
