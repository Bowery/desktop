<!--
Copyright (c) 2014 Bowery, Inc. All rights reserved.
-->

<!--
`bowery-apps` shows a list of applications and their states.
-->
<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../core-ajax/core-ajax.html">

<polymer-element name="bowery-apps" attributes="applications app">
  <template>
    <link rel="stylesheet" href="../../bowery/out.css">
    <style>
      :host {
        display: block;
        background: #361B4B;
        height: 377px;
        overflow: auto;
      }

      #message {
        display: none;
        padding: 18px;
      }
    </style>
    <div id="container" class="">
      <template repeat="{{app in applications}}">
        <div class="card" data-id="{{app._id}}" on-click="{{goToEditApp}}">
          <h4>{{app.name}}</h4>
          <span class="unclickable" class="{{app.status != 'running' ? 'error' : ''}}">{{app.status != 'running' ? app.status : (app.location || 'Your application is provisioning')}}</span>
        </div>
      </template>
    </div>
  </template>
  <script>
  Polymer('bowery-apps', {
    created: function () {
      this.applications = []
    },
    goToEditApp: function (e) {
      if (e.target.className == 'unclickable')
        return

      var id = e.target.dataset.id || e.target.parentNode.dataset.id
      this.app = this.applications.filter(function (a) {return a._id == id})[0]

      this.app.image = this.app.environment.name

      this.fire('bowery-navigate', {path: '/apps/edit'})
    }
  })
  </script>
</polymer-element>
