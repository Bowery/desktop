<!--
Copyright (c) 2014 Bowery, Inc. All rights reserved.
-->

<!--
`bowery-core` is the bowery desktop app

@group Bowery Core Elements
@element bowery-core
-->
<link rel="import" href="bowery-screen.html">
<link rel="import" href="bowery-nav.html">
<link rel="import" href="bowery-apps.html">
<link rel="import" href="bowery-form.html">
<link rel="import" href="bowery-modal.html">
<link rel="import" href="bowery-analytics.html">

<polymer-element name="bowery-core">
<template>
<bowery-analytics id="analytics"></bowery-analytics>
<link rel="stylesheet" href="../../bowery/out.css">
<style>
  span, pre {
    color: white;
  }
  :host {
    overflow-x: hidden;
  }

  .test-modal {
    position: relative;
    background: white;
    height: 45px;
    width: 345px;
    margin-top: 80px;
    margin-left: 9px;
  }
</style>
<bowery-nav type="header">Bowery</bowery-nav>

<bowery-screen path="/">
  <div class="test-modal">
    <bowery-modal style="right: 9px; top: 11px" color="rgb(251, 77, 83)">
      <h2>bind: address already in use</h2>
      <pre style="overflow: auto">
  2014/08/29 14:16:51 /Users/david/Documents/gocode/src/github.com/Bowery/desktop/bin <nil>
  [negroni] listening on :32055
  [negroni] listen tcp :32055: bind: address already in use
      </pre>
      <span>What command should I run to fix this?</span>
      <textarea style="outline: none; width: 100%; height: 90px; background: rgb(245, 245, 245); border: none; resize: none;"></textarea>
    </bowery-modal>
  </div>
  <div class="test-modal">
    <bowery-modal style="right: 9px; top: 11px" color="rgb(251, 77, 83)">
      <h2>bind: address already in use</h2>
      <pre style="overflow: auto">
  2014/08/29 14:16:51 /Users/david/Documents/gocode/src/github.com/Bowery/desktop/bin <nil>
  [negroni] listening on :32055
  [negroni] listen tcp :32055: bind: address already in use
      </pre>
      <span>What command should I run to fix this?</span>
      <textarea style="outline: none; width: 100%; height: 90px; background: rgb(245, 245, 245); border: none; resize: none;"></textarea>
    </bowery-modal>
  </div>
  <div class="test-modal">
    <bowery-modal style="right: 9px; top: 11px" color="rgb(251, 77, 83)">
      <h2>bind: address already in use</h2>
      <pre style="overflow: auto">
  2014/08/29 14:16:51 /Users/david/Documents/gocode/src/github.com/Bowery/desktop/bin <nil>
  [negroni] listening on :32055
  [negroni] listen tcp :32055: bind: address already in use
      </pre>
      <span>What command should I run to fix this?</span>
      <textarea style="outline: none; width: 100%; height: 90px; background: rgb(245, 245, 245); border: none; resize: none;"></textarea>
    </bowery-modal>
  </div>
</bowery-screen>

<bowery-screen path="/login">
  <bowery-form title="login" on-bowery-form-response="{{handleLoginAttempt}}" endpoint="http://broome.io/developers/token" fields="email password" sendAs="json"></bowery-form>
</bowery-screen>

<bowery-screen path="/signup">
  <bowery-form title="signup" endpoint="http://broome.io/developers" fields="email password name"></bowery-form>
</bowery-screen>

<bowery-screen path="/apps">
  <bowery-apps></bowery-apps>
  <bowery-nav type="footer" path="/apps/new">Create App</bowery-nav>
</bowery-screen>

<bowery-screen path="/apps/new">
  <bowery-nav type="header">Bowery</bowery-nav>
  <bowery-form title="Provision" endpoint="http://localhost:32055/apps" fields="name start build size local-path remote-path aws-key aws-secret"></bowery-form>
</bowery-screen>

</template>
<script>
Polymer('bowery-core', {
  ready: function () {
    this.$.analytics.track("Opened App")
  },
  handleLoginAttempt: function (e) {
    var title = e.target.title
      , response = e.target.response

    if (response.status != "created") {
      return e.target.giveFeedback(response.error)
    }
    this.fire('bowery-navigate', {path: '/apps'})
  }
})
</script>
</polymer-element>
