<!--
Copyright (c) 2014 Bowery, Inc. All rights reserved.
-->

<!--
`bowery-card` creates an expandable block of content. By default the card will be collapsed. Use `opened` to show/hide the content. When the content is expanded, it will become editable.

  <button on-click="{{toggle}}">toggle card</button>
  <bowery-card id="collapse"></bowery-card>

  ...

  toggle: function() {
    this.$.collapse.toggle();
  }
@group Bowery Core Elements
@element bowery-card
-->

<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../core-collapse/core-collapse.html">

<polymer-element name="bowery-card" attributes="opened expandable">
<template>
  <link rel="stylesheet" href="../../bowery/out.css">
  <style>
    #card {
      background: white;
      padding: 10px;
      margin: 9px 18px;
      width: 345px;
      height: 33px;
      float: left;
      position: relative;
      transition: all 300ms ease-in;
    }
    #card.expanded {
      position: absolute;
      top: 54px;
      left: 0;
      right: 0;
      background: white;
      z-index: 1;
    }
    #card .expander {
      position: absolute;
      top: 18px;
      right: 18px;
      text-decoration: none;
      opacity: 0;
      transition: opacity 200ms;
    }
    #card:hover .expander {
      opacity: 1;
    }
    :host {
      float: left;
      /*overflow: hidden;*/
      /*position: relative;*/
    }
  </style>
  <div id="card">
    <content select="h4"></content>
    <content select="span"></content>
    <content></content>
  </div>
</template>
<script>
Polymer({
  ready: function () {
    var self = this
    document.addEventListener('core-resize', function (e) {
      if (self.editMode) {
        self.fire('bowery-card-expand', {offsetTop: self.offsetTop})
      }
    })
  },
  toggle: function (e) {
    e.preventDefault()

    // The modal can't be part of the card. It needs to be its own component that's position absolute

    this.editMode = e.target.innerHTML == 'EDIT'
    e.target.innerHTML = this.editMode ? 'SAVE' : 'EDIT'
    this.$.card.classList[this.editMode ? 'add' : 'remove']('expanded')

    this.$.collapse.toggle()
  }
})
</script>
</polymer-element>
